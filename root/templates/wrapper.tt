<!DOCTYPE html>
<html lang="en">
<head>
    <title>
        [% title        _ ' · ' | html IF title %]
        [% project.name _ ' · ' | html IF project %]
        [% name | html %]
    </title>

    <meta charset="UTF-8">

    <meta name="description" content="[% meta_description %]">
    <meta name="keywords"    content="[% meta_keywords %]">
    <meta name="robots"      content="[% meta_robots %]">

[% IF canonical_url %]
    <link rel="canonical" href="[% canonical_url %]">
[% END %]

[% IF icon_url %]
    <link rel="icon" type="[% icon_type %]" href="[% icon_url %]">
[% END %]
[% FOR sizes IN icon_urls.keys %]
    <link rel="apple-touch-icon-precomposed" [% IF sizes.length %]sizes="[% sizes %]"[% END %] href="[% icon_urls.$sizes %]">
[% END %]

[% FOREACH path IN css %]
    <link rel="stylesheet" href="[% path %]">
[% END %]
</head>

<body>
<!--container div is necessary to keep the footer down, see https://matthewjamestaylor.com/bottom-footer -->
<div id="container">
<header>

<nav id="user_nav">
<div id="h1-div">
	<h1>
		<a href="[% homepage_url %]">[% name | html %]</a>
	</h1>
</div>

<ul>
[% IF user %]<h4>Welcome to [% name | html %], <a href="[% user_url %]">[% user.display_name | html %]</a></h4>[% END %]

[% IF logout_url %]
[% IF project %]
	<p>You’re currently working on <a href="[% project_urls.project %]">project [% project.name | html%]</a></p>
[% ELSE %]
	<p>Please create or choose a project now.</p>
[% END %]
[% END %]

<div>
[% IF login_url %]
    <li><a href="[% login_url %]">Sign in</a></li>
[% END %]

[% IF register_url %]
    <li><a href="[% register_url %]">Sign up</a></li>
[% END %]

[% IF settings_url %]
    <li><a href="[% settings_url %]">Settings</a></li>
[% END %]

[% IF logout_url %]
    <li>
        <form class="inline" method="post" action="[% logout_url %]">
            <input type="submit" name="logout" value="Sign out">
        </form>
    </li>
[% END %]
</div>

</ul>
</nav>



<nav id="project_nav" class="navbar navbar-expand-md navbar-dark bg-dark">
	<div class="container-fluid">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerLevel1" aria-controls="navbarTogglerLevel1" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarTogglerLevel1">
			<ul class="navbar-nav mr-auto mt-2 mt-lg-0">
				
[% IF dashboard_url %]
				<li class="nav-item"><a class="nav-link" href="[% dashboard_url %]">Start</a></li>
[% ELSIF homepage_url %]
				<li class="nav-item"><a class="nav-link" href="[% homepage_url %]">Start</a></li>
[% END %]

[% IF project_urls %]
    
				<li class="nav-item"><a class="nav-link" href="[% project_urls.project %]">Project</a></li>
				<li class="nav-item"><a class="nav-link" href="[% project_urls.recipes %]">Recipes</a></li>
				<li class="nav-item"><a class="nav-link" href="[% project_urls.articles %]">Articles</a></li>
				<li class="nav-item"><a class="nav-link" href="[% project_urls.tags %]">Tags</a></li>
				<li class="nav-item"><a class="nav-link" href="[% project_urls.purchase_lists %]">Purchase Lists</a></li>
				<li class="nav-item"><a class="nav-link" href="[% project_urls.units %]">Units</a></li>
				<li class="nav-item"><a class="nav-link" href="[% project_urls.import %]">Import</a></li>
[% END %]

			</ul>
		</div>
	
	</div>
</nav>



<nav id="submenu_nav" class="navbar navbar-expand-md navbar-light bg-kdark">
	<div class="container-fluid">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerLevel2" aria-controls="navbarTogglerLevel2" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarTogglerLevel2">
			<ul class="navbar-nav mr-auto mt-2 mt-lg-0">

[% FOR item IN submenu_items;
    IF item.url %]
				<li class="nav-item"><a class="nav-link" href="[% item.url %]">[% item.text %]</a></li>
    [% ELSE; # TODO setting href="" doesn’t work if page is response to POST request and URL isn’t available via GET %]
				<li class="nav-item"><a class="nav-link" href="" class="current">[% item.text %]</a></li>
    [% END;
END %]
			</ul>
		</div>
	</div>
</nav>
</header>




<main>
	<div class="container-fluid">
		<div class="row">
			<div class="col-12">
				<h1 id="print_h1" style="display: none">[% name | html; IF project %]: [% project.name | html; END %]</h1>

[% IF html_title %]<h2>[% html_title # may contain HTML %]</h2>
[% ELSIF   title %]<h2>[% title | html %]</h2>
[% END %]

[% WHILE (message = messages.next) %]
				<div class="message message-[% message.type %]">
    [% IF message.html;
        message.html;
    ELSE %]
					<p>[% message.text | html %]</p>
    [% END %]
				</div>
[% END %]
			</div>
		</div>
	</div>

[% content %]
</main>

<footer class="bg-dark text-white">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md">
				<h4>Browse</h4>
				<ul>
					<li><a href="[% recipes_url %]">Recipes</a></li>
					<li><a href="[% projects_url %]">Projects</a></li>
				</ul>
			</div>
[% IF project_urls %]
			<div class="col-md">
				<h4>Project Parameters</h4>
				<ul> 
					<li><a href="[% project_urls.units %]">Units & Quantities</a></li>
					<li><a href="[% project_urls.tags %]">Tags</a></li>
					<li><a href="[% project_urls.shop_sections %]">Shop Sections</a></li>
				</ul>
			</div>
[% END %]
			<div class="col-md">
				<h4>Get Help</h4>
				<ul>
[% IF faq_url %]
					<li><a href="[% faq_url %]"><abbr title="Frequently Asked Questions">FAQ</abbr></a></li>
[% END %]
[% FOR help_link IN help_links %]
					<li><a href="[% help_link.url %]">[% help_link.title | html %]</a></li>
[% END %]			
				</ul>
				
			</div>
			
[% IF admin_url %]
			<div class="col-md">
				<h4><a href="[% admin_url %]">Admin</a></h4>
				<ul>   
					<li><a href="[% admin_urls.faq %]">FAQ</a></li>
					<li><a href="[% admin_urls.organizations %]">Organizations</a></li>
					<li><a href="[% admin_urls.projects %]">Projects</a></li>
					<li><a href="[% admin_urls.terms %]">Terms</a></li>
					<li><a href="[% admin_urls.users %]">Users</a></li>
				</ul>
			</div>
[% END %]		

			
			<div class="col-md">
				<h4>About [% name | html %]</h4>
				<ul>
					<li><a href="[% statistics_url %]">Statistics</a></li>
					<li><a href="[% about_url %]">[% about_title %]</a></li>
[% IF terms_url %]
					<li><a href="[% terms_url %]">Terms</a></li>
[% END %]
				</ul>
				
			</div>
			
	</div>
</footer>





[% FOR path IN js %]
<script src="[% path %]"></script>
[% END %]

[% footer_html %]

</div>
</body>
</html>
