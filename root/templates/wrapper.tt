<!DOCTYPE html>
<html lang="en">
<head>
    <title>
        [% title        _ ' · ' | html IF title %]
        [% project.name _ ' · ' | html IF project %]
        [% name | html %]
    </title>

    <meta charset="UTF-8">

    <meta name="description" content="[% meta_description %]">
    <meta name="keywords"    content="[% meta_keywords %]">
    <meta name="robots"      content="[% meta_robots %]">

[% IF canonical_url %]
    <link rel="canonical" href="[% canonical_url %]">
[% END %]

[% IF icon_url %]
    <link rel="icon" type="[% icon_type %]" href="[% icon_url %]">
[% END %]
[% FOR sizes IN icon_urls.keys %]
    <link rel="apple-touch-icon-precomposed" [% IF sizes.length %]sizes="[% sizes %]"[% END %] href="[% icon_urls.$sizes %]">
[% END %]

[% FOREACH path IN css %]
    <link rel="stylesheet" href="[% path %]">
[% END %]
</head>

<body>
<!--container div is necessary to keep the footer down, see https://matthewjamestaylor.com/bottom-footer -->
<div id="container">
    <header class="sticky-top">

        <div class="w-100 p-0 m-0">
            <div class="row p-0 m-0">
                <div class="col-12 p-0 m-0 ">
                    <nav class="navbar p-0 m-0 navbar-expand-md navbar-dark bg-dark">
                        <div class="navbar-toggler-right">
                            <button class="navbar-toggler px-1 ml-4" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                        </div>

                        <div class="collapse navbar-collapse flex-column" id="navbar">
                            <div class="navbar-nav container-md d-flex justify-content-between align-items-center w-100 py-2 px-2">
                                <div class="d-flex gap-2 mx-2">
                                    <a class="navbar-brand text-white fs-4 fw-bold" href="[% homepage_url %]">[% name | html %]</a>
                                    <ul class="d-flex p-0 m-0" id="project_nav">
                                        <li class="nav-item group-end"><a class="nav-link [% font_color %]" href="[% dashboard_url ? dashboard_url : homepage_url %]">Start</a></li>
[% IF project_urls %]
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.project %]">Project</a></li>
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.recipes %]">Recipes</a></li>
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.articles %]">Articles</a></li>
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.tags %]">Tags</a></li>
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.purchase_lists %]">Purchase Lists</a></li>
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.units %]">Units</a></li>
                                        <li class="nav-item"><a class="nav-link" href="[% project_urls.import %]">Import</a></li>
[% END %]
                                    </ul>
                                </div>
                                <div class="d-flex gap-2 mx-2">
[% IF login_url %]
                                    <a class="btn btn-sm dark-link" href="[% login_url %]">Sign in</a>
[% END %]
[% IF register_url %]
                                    <a class="btn btn-outline-light btn-sm dark-link" href="[% register_url %]">Sign up</a>
[% END %]

[% IF user %]
                                    <div class="dropdown">
                                        <a class="nav-link dropdown-toggle dark-link" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="material-icons">person</i> [% user.display_name | html %]
                                        </a>
                                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                                            <li><a class="dropdown-item" href="[% user_url %]">Profile</a></li>
    [% IF settings_url %]
                                            <li><a class="dropdown-item" href="[% settings_url %]">Settings</a></li>
    [% END %]
    [% IF logout_url %]
                                            <li><form class="px-3 py-2" method="post" action="[% logout_url %]">
                                                <button class="btn btn-sm btn-outline-light dark-link w-100" name="logout">Sign out</button>
                                            </form></li>
    [% END %]
                                        </ul>
                                    </div>
[% END %]

                                </div>
                            </div>

                            <div class="w-100" id="submenu_nav">
                                <div class="navbar-nav d-flex justify-content-between align-items-center container-md px-2">
                                    <ul class="d-flex p-0 m-0">
[% FOR item IN submenu_items;
    IF item.url %]
                                        <li class="nav-item"><a class="nav-link text-dark" href="[% item.url %]">[% item.text %]</a></li>
    [% ELSE; # TODO setting href="" doesn’t work if page is response to POST request and URL isn’t available via GET %]
                                        <li class="nav-item active"><a class="nav-link" href="" class="current">[% item.text %]</a></li>
    [% END;
END %]
                                    </ul>
                                    <div>
[% IF logout_url %]
    [% IF project %]
                                        <p class="text-dark my-2">You’re currently working on <a class="text-dark" href="[% project_urls.project %]">project [% project.name | html%]</a></p>
    [% ELSE %]
                                        <p class="text-dark my-2">Please create or choose a project now.</p>
    [% END %]
[% END %]
                                    </div>
                                </div>
                            </div>
                        </div>

                    </nav>
                </div>
            </div>

        </div>
    </header>


    <main>
        <div class="container-md pb-2"><!-- main container-fluid -->
            <div class="row py-3">

                <div class="col-12">
                    <h1 id="print_h1" style="display: none">[% name | html; IF project %]: [% project.name | html; END %]</h1>

[% IF html_title %]<h2>[% html_title # may contain HTML %]</h2>
[% ELSIF   title %]<h2>[% title | html %]</h2>
[% END %]

[% WHILE (message = messages.next) %]
                    <div class="message message-[% message.type %]">
    [% IF message.html;
            message.html;
    ELSE %]
                        <p>[% message.text | html %]</p>
    [% END %]
                    </div>
[% END %]
                </div>
            </div>
    [% content %]
        </div><!-- END main container-fluid -->
    </main>

    <footer class="bg-dark text-white">
        <div class="container-md">
            <div class="row">
                <div class="col-md">
                    <h3><span class="tiny">Browse</span></h3>
                    <ul class="list-unstyled small">
                        <li><a class="dark-link" href="[% recipes_url %]">Recipes</a></li>
                        <li><a class="dark-link" href="[% projects_url %]">Projects</a></li>
                    </ul>
                </div>

                <div class="col-md">
                    <h3><span class="tiny">Get Help</span></h3>
                    <ul class="list-unstyled small">
[% IF faq_url %]
                        <li><a class="dark-link" href="[% faq_url %]"><abbr title="Frequently Asked Questions">FAQ</abbr></a></li>
[% END %]
[% FOR help_link IN help_links %]
                        <li><a class="dark-link" href="[% help_link.url %]">[% help_link.title | html %]</a></li>
[% END %]
                    </ul>

                </div>

[% IF admin_url %]
                <div class="col-md">
                    <h3><span class="tiny"><a class="dark-link" href="[% admin_url %]">Admin</a></span></h3>
                    <ul class="list-unstyled small">
                        <li><a class="dark-link" href="[% admin_urls.faq %]">FAQ</a></li>
                        <li><a class="dark-link" href="[% admin_urls.organizations %]">Organizations</a></li>
                        <li><a class="dark-link" href="[% admin_urls.projects %]">Projects</a></li>
                        <li><a class="dark-link" href="[% admin_urls.terms %]">Terms</a></li>
                        <li><a class="dark-link" href="[% admin_urls.users %]">Users</a></li>
                    </ul>
                </div>
[% END %]


                <div class="col-md">
                    <h3><span class="tiny">About [% name | html %]</span></h3>
                    <ul class="list-unstyled small">
                        <li><a class="dark-link" href="[% statistics_url %]">Statistics</a></li>
                        <li><a class="dark-link" href="[% about_url %]">[% about_title %]</a></li>
[% IF terms_url %]
                        <li><a class="dark-link" href="[% terms_url %]">Terms</a></li>
[% END %]
                    </ul>

                </div>
            </div>
        </div>
    </footer>

[% FOR path IN js %]
    <script src="[% path %]"></script>
[% END %]

[% INCLUDE 'wrapper_footer.tt' %]

</div>
</body>
</html>
